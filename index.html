<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏£‡∏≠‡∏ö</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background: #f0f0f0;
      margin: 0;
      padding: 2em;
    }
    #previewContainer {
      position: relative;
      width: 300px;
      height: 300px;
      margin: auto;
      background: #fff;
      overflow: hidden;
    }
    #previewContainer img {
      position: absolute;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    #frameImage {
      z-index: 10;
    }
    #loadingOverlay {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      color: white;
      font-size: 24px;
      align-items: center;
      justify-content: center;
      z-index: 999;
    }
  </style>
</head>
<body>

  <h2>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏£‡∏≠‡∏ö</h2>
  <div id="previewContainer">
    <img id="userImage" src="https://via.placeholder.com/600x600.png?text=Your+Photo" alt="User" />
    <img id="frameImage" src="https://via.placeholder.com/600x600.png?text=Frame" alt="Frame" />
  </div>

  <br>
  <button id="downloadBtn">üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û</button>
  <p><small>üì± ‡∏´‡∏≤‡∏Å‡πÉ‡∏ä‡πâ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠: ‡∏Å‡∏î ‚Äú‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‚Äù ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡∏∞‡∏Ñ‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏†‡∏≤‡∏û ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û"</small></p>

  <div id="loadingOverlay">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</div>

  <!-- html2canvas -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    const downloadBtn = document.getElementById('downloadBtn');
    const userImagePreview = document.getElementById('userImage');
    const frameImagePreview = document.getElementById('frameImage');
    const loadingOverlay = document.getElementById('loadingOverlay');

    // ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏£‡∏π‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß
    const userImageLoaded = true;
    const frameImageLoaded = true;
    const selectedFrame = "default";

    // ‡∏Ñ‡πà‡∏≤‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢/‡∏ã‡∏π‡∏°
    const initialTranslateX = 0;
    const initialTranslateY = 0;
    const currentScale = 1;

    downloadBtn.addEventListener('click', function () {
      if (!userImageLoaded || !frameImageLoaded || !selectedFrame) {
        alert('‡πÇ‡∏õ‡∏£‡∏î‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î');
        return;
      }

      loadingOverlay.style.display = 'flex';

      const tempRenderDiv = document.createElement('div');
      tempRenderDiv.style.width = '1920px';
      tempRenderDiv.style.height = '1920px';
      tempRenderDiv.style.position = 'absolute';
      tempRenderDiv.style.left = '-9999px';
      tempRenderDiv.style.top = '-9999px';
      tempRenderDiv.style.display = 'flex';
      tempRenderDiv.style.alignItems = 'center';
      tempRenderDiv.style.justifyContent = 'center';
      tempRenderDiv.style.overflow = 'hidden';
      tempRenderDiv.style.backgroundColor = 'transparent';
      document.body.appendChild(tempRenderDiv);

      const hiResUserImage = new Image();
      const hiResFrameImage = new Image();

      hiResUserImage.src = userImagePreview.src;
      hiResFrameImage.src = frameImagePreview.src;

      hiResUserImage.style.transform = `translate(${initialTranslateX}%, ${initialTranslateY}%) scale(${currentScale})`;
      hiResUserImage.style.transformOrigin = 'center center';
      hiResUserImage.style.objectFit = 'cover';
      hiResUserImage.style.width = '100%';
      hiResUserImage.style.height = '100%';
      hiResUserImage.style.position = 'absolute';
      hiResUserImage.style.zIndex = '5';

      hiResFrameImage.style.width = '100%';
      hiResFrameImage.style.height = '100%';
      hiResFrameImage.style.position = 'absolute';
      hiResFrameImage.style.zIndex = '10';
      hiResFrameImage.style.objectFit = 'contain';

      tempRenderDiv.appendChild(hiResUserImage);
      tempRenderDiv.appendChild(hiResFrameImage);

      Promise.all([
        new Promise(resolve => {
          if (hiResUserImage.complete && hiResUserImage.naturalWidth > 0) resolve();
          else hiResUserImage.onload = resolve;
        }),
        new Promise(resolve => {
          if (hiResFrameImage.complete && hiResFrameImage.naturalWidth > 0) resolve();
          else hiResFrameImage.onload = resolve;
        })
      ]).then(() => {
        setTimeout(() => {
          html2canvas(tempRenderDiv, {
            width: 1920,
            height: 1920,
            scale: 1,
            backgroundColor: null,
            useCORS: true
          }).then(canvas => {
            document.body.removeChild(tempRenderDiv);
            const imgData = canvas.toDataURL('image/png');

            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            if (isMobile) {
              const newTab = window.open();
              newTab.document.write(`<p style="text-align:center;">‡πÅ‡∏ï‡∏∞‡∏Ñ‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏†‡∏≤‡∏û‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p><img src="${imgData}" style="width:100%">`);
            } else {
              const link = document.createElement('a');
              link.download = `profile-${selectedFrame}-gama-awards.png`;
              link.href = imgData;
              link.click();
            }

            loadingOverlay.style.display = 'none';
          }).catch(err => {
            alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
            document.body.removeChild(tempRenderDiv);
            loadingOverlay.style.display = 'none';
          });
        }, 100);
      });
    });
  </script>
</body>
</html>
